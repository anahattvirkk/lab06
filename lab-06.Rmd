---
title: "Lab 06 - Ugly charts and Simpson's paradox"
author: "Anahatt Virk"
date: "07/04/2025"
output: github_document
---

### Load packages and data
```{r info}
library(usethis)
use_git_config(
  user.name = "Anahatt Virk",
  user.email = "virka22@wfu.edu")
```

```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox)
library(mosaicData) 
```

### Exercise 1

```{r load-data}
staff <- read_csv("data/instructional-staff.csv")
```

```{r reshape}
staff_long <- staff %>%
  pivot_longer(cols = -faculty_type, names_to = "year") %>%
  mutate(value = as.numeric(value))

staff_long
```

```{r plot}
staff_long %>%
  ggplot(aes(x = year, y = value, group = faculty_type, color = faculty_type)) +
  geom_line() +
  labs(title = "Instructional Staff Over Time by Faculty Type", x = "Year", y = "Number of Staff", color = "Faculty Type") +
  theme_minimal()
```

### Exercise 2

To show that the proportion of part-time faculty have gone up over time, I would change the previous plot in order to show the proportions within each year, instead of the raw counts. The y-axis label would have to be updated to reflect proportions instaed of number of staff. The updated graph has been included below. 

```{r proportions}
staff_prop <- staff_long %>%
  group_by(year) %>%
  mutate(proportion = value / sum(value)) %>%
   ungroup()
```

```{r proportion-plot}
staff_prop %>%
  ggplot(aes(x = year, y = proportion, group = faculty_type, color = faculty_type)) +
  geom_line() +
  labs(title = "Proportion of Instructional Staff by Faculty Type Over Time", x = "Year", y = "Proportion of Staff", color = "Faculty Type") +
   theme_minimal()
```

### Exercise 3

...

Add exercise headings as needed.
